<mat-drawer-container>
	<mat-drawer #drawer mode="over" position="end">
		<router-outlet *ngIf="loading >= 100" name="right"></router-outlet>
	</mat-drawer>

	<mat-drawer-content style="display: flex; flex-direction: column">
		<mat-toolbar fxLayout="row" fxLayoutAlign="space-between center"
					 style="background-color: #444444; z-index: 1000">
			<div fxLayout="row" fxLayoutGap="12px" style="align-items: center">
				<button id="home"
						mat-stroked-button
						routerLink="/">
					<mat-icon style="height: 32px; width: 32px;" svgIcon="webdb"></mat-icon>
				</button>

				<div *ngIf="selectedServer && selectedDatabase" id="server">
					<div>
						<span>{{selectedServer.host}}</span>:<span>{{selectedServer.port}}</span>/<span>{{selectedDatabase.name}}</span>
					</div>
					<button
						(click)="request.reloadServer()"
						*ngIf="loading >= 100"
						mat-icon-button>
						<span class="material-symbols-outlined notranslate">
							refresh
						</span>
					</button>
				</div>
			</div>

			<div class="flex-spacer"></div>

			<mat-button-toggle-group
				(click)="drawer.toggle();"
				class="panel">
				<mat-button-toggle
					*ngFor="let panel of panels"
					[routerLinkActive]="'mat-button-toggle-checked'"
					[routerLink]="[{outlets: {right: [panel.link]}}]"
				>
					<span class="material-symbols-outlined notranslate">
						{{panel.icon}}
					</span>
				</mat-button-toggle>
			</mat-button-toggle-group>

			<button [matMenuTriggerFor]="external" mat-icon-button style="margin-left: 14px">
				<span class="material-symbols-outlined notranslate">
					apps
				</span>
			</button>
		</mat-toolbar>

		<div *ngIf="loading < 100"
			 style="height: calc(100vh - 56px); align-self: center; display: flex;">
			<div *ngIf="loading >= 0"
				 style="align-self: center;">
				<mat-spinner
					mode="indeterminate"
					style="margin: 0px auto;"></mat-spinner>
				<h2 style="color: #2196f3">Loading {{activatedRoute.snapshot.paramMap.get('database')}} ...</h2>
			</div>

			<mat-error *ngIf="loading === -1">
				Can't connect to {{activatedRoute.snapshot.paramMap.get('server')}}
				/{{activatedRoute.snapshot.paramMap.get('database')}}, please check server availability
			</mat-error>
		</div>

		<router-outlet *ngIf="loading >= 100"></router-outlet>
	</mat-drawer-content>
</mat-drawer-container>

<mat-menu #external="matMenu" class="external">
	<a href="https://gitlab.com/web-db/landing/"
	   mat-menu-item
	   target="_blank">
		<mat-icon svgIcon="gitlab"></mat-icon>
		Gitlab
	</a>
	<a href="https://stackoverflow.com/users/21482136/webdb"
	   mat-menu-item
	   target="_blank">
		<mat-icon svgIcon="stackoverflow"></mat-icon>
		Stack Overflow
	</a>
	<mat-divider></mat-divider>
	<a (click)="showSettings()"
	   mat-menu-item>
		<span class="material-symbols-outlined notranslate">
			tune
		</span>
		Configuration
	</a>
	<a (click)="showSubscription()"
	   mat-menu-item>
		<span class="material-symbols-outlined notranslate">
			shopping_bag
		</span>
		Subscription
	</a>
	<a mat-menu-item>
		<mat-icon svgIcon="webdb"></mat-icon>
		v{{packageJson.version}}
	</a>
</mat-menu>
