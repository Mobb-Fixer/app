<mat-drawer-container fxFlexFill>

	<mat-drawer #drawer mode="over" position="end">
		<router-outlet *ngIf="!isLoading" name="right"></router-outlet>
	</mat-drawer>

	<mat-drawer-content>
		<mat-toolbar fxLayout="row" fxLayoutAlign="space-between center" style="background-color: #444444">
			<div fxLayout="row" fxLayoutGap="12px" style="align-items: center">
				<button [disabled]="router.url === '/'"
						[style.background-color]="router.url === '/' ? 'transparent' : '#1a1a1a'"
						id="home"
						mat-flat-button
						routerLink="/">
					<mat-icon style="height: 32px; width: 32px;" svgIcon="webdb"></mat-icon>
				</button>

				<div *ngIf="router.url === '/'">
					<span id="title">
						WebDB
					</span>
					<span style="font-size: 16px; padding-left: 16px;">v{{packageJson.version}}</span>
				</div>

				<ng-container *ngIf="server && database">
					<span (click)="reloadDbs()" matTooltip="wrapper: {{server.wrapper}}
user: {{server.user}}
password: {{server.password}}
params: {{displayParams()}}" id="serverName">
						<span>{{server.host}}</span>:<span>{{server.port}}</span>/<span>{{database.name}}</span>
					</span>
				</ng-container>
			</div>

			<div class="flex-spacer"></div>

			<mat-button-toggle-group
				(click)="drawer.toggle();"
				*ngIf="router.url !== '/'"
				class="panel">
				<mat-button-toggle
					*ngFor="let panel of panels"
					[routerLinkActive]="'mat-button-toggle-checked'"
					[routerLink]="[{outlets: {right: [panel.link]}}]"
				>
					<span class="material-symbols-outlined">
						{{panel.icon}}
					</span>
				</mat-button-toggle>
			</mat-button-toggle-group>

			<button [matMenuTriggerFor]="external" mat-icon-button style="margin-left: 14px">
				<span class="material-symbols-outlined">
					apps
				</span>
			</button>
		</mat-toolbar>

		<div *ngIf="router.url === '/'">
			<app-servers></app-servers>
		</div>

		<router-outlet *ngIf="!isLoading"></router-outlet>
	</mat-drawer-content>
</mat-drawer-container>


<ng-template #iconTemplate></ng-template>

<mat-menu #external="matMenu" class="external">
	<a href="https://gitlab.com/web-db/landing/-/issues"
	   mat-menu-item
	   target="_blank">
		<span class="material-symbols-outlined">
			support
		</span>
		Support
	</a>
	<a href="https://gitlab.com/web-db/landing/-/wikis/Welcome"
	   mat-menu-item
	   target="_blank">
		<span class="material-symbols-outlined">
			menu_book
		</span>
		Documentation
	</a>

	<a href="https://twitter.com/Webdb_app"
	   mat-menu-item
	   target="_blank">
		<mat-icon svgIcon="twitter"></mat-icon>
		Twitter
	</a>

	<a (click)="showSettings()"
	   mat-menu-item
	   target="_blank">
		<span class="material-symbols-outlined">
			tune
		</span>
		Configuration
	</a>

	<a (click)="showSubscription()"
	   mat-menu-item
	   target="_blank">
		<span class="material-symbols-outlined">
			shopping_bag
		</span>
		Subscription
	</a>

	<a [href]="env.stripeUserLink"
	   mat-menu-item
	   target="_blank">
		<span class="material-symbols-outlined">
			credit_card
		</span>
		Account
	</a>

</mat-menu>
