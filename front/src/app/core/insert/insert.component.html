<div class="random">
	<mat-toolbar fxLayout="row" fxLayoutAlign="space-between center">

		<div>
			<button (click)="generate(+addGenNb.value, static)" color="primary" mat-flat-button>
				<span class="material-symbols-outlined notranslate">
					auto_mode
				</span>
				Generate Rows
			</button>

			<mat-form-field style="width: 65px; text-align: right; margin-bottom: -0.5em;">
				<input #addGenNb matInput min="1" type="number" value="1">
			</mat-form-field>
		</div>

		<div>
			<a href="https://v7.fakerjs.dev/api/"
			   mat-button
			   target="_blank">
				<span class="material-symbols-outlined notranslate">
					menu_book
				</span>
				Faker
			</a>
			<a href="https://gitlab.com/web-db/landing/-/wikis/Generator"
			   mat-button
			   target="_blank">
				<span class="material-symbols-outlined notranslate">
					menu_book
				</span>
				Generator
			</a>
		</div>
	</mat-toolbar>

	<mat-tab-group mat-align-tabs="center">
		<mat-tab
			*ngFor="let random of randomSource"
			[label]="random.column.name"
			[labelClass]="random.error ? 'tab-error': ''"
		>
			<div style="display: flex">

				<ngx-monaco-editor
					style="width: 100%; height: 30vh"
					[(ngModel)]="random.model"
					[options]="editorOptions"
					(onInit)="initEditor($event, random.column.name)"
				>
				</ngx-monaco-editor>

				<div class="infos">
					<h3 style="margin: 0px; color: #2196f3">
						{{random.column.type}}
					</h3>

					<button
						mat-stroked-button
						(click)="random.model = beautify('(() => {return undefined})()')">
						<span class="material-symbols-outlined notranslate">
							check_box_outline_blank
						</span>
						Null / Default
					</button>

					<button
						mat-stroked-button
						(click)="sampleData(random)">
						<span class="material-symbols-outlined notranslate">
							frame_inspect
						</span>
						Sample Data
					</button>
				</div>
			</div>

			<ng-container>
				<mat-error>{{random.error}}</mat-error>
			</ng-container>
		</mat-tab>
	</mat-tab-group>
</div>

<div class="static" #static>
	<mat-toolbar fxLayout="row" fxLayoutAlign="space-between center">
		<div>
			<button (click)="addRows(+addRowNb.value)" mat-stroked-button>
				<span class="material-symbols-outlined notranslate">
					add
				</span>
				Empty Rows
			</button>
			<mat-form-field style="width: 65px; text-align: right">
				<input #addRowNb
					   matInput
					   min="1"
					   type="number"
					   value="1">
			</mat-form-field>
		</div>

		<input #inputFile (change)="inputChange($event)" accept=".json, .csv" hidden="true" onclick="this.value=null"
			   type="file"/>
		<button (click)="inputFile.click()" mat-stroked-button>
			<span class="material-symbols-outlined notranslate">
				upload_file
			</span>
			Import CSV/JSON File
		</button>

		<button (click)="insert()"
				[disabled]="dataSource.data.length < 1"
				color="accent"
				mat-flat-button>
			<span class="material-symbols-outlined notranslate">
				note_add
			</span>
			Insert Rows
		</button>
	</mat-toolbar>

	<div class="scrollDiv mat-elevation-z8">
		<table [dataSource]="dataSource" class="table" mat-table>
			<ng-container
				*ngFor="let column of displayedColumns"
				matColumnDef="{{column}}"
			>
				<ng-container *ngIf="column === actionColum">
					<th *matHeaderCellDef mat-header-cell style="width: 0px;">
						<button (click)="removeRows()"
								[disabled]="selection.isEmpty()"
								color="warn"
								mat-icon-button>
							<span class="material-symbols-outlined notranslate">
								delete
							</span>
						</button>
						<mat-checkbox
							color="warn"
							(change)="$event ? toggleAllRows() : null"
							[checked]="selection.hasValue() && isAllSelected()"
							[indeterminate]="selection.hasValue() && !isAllSelected()">
						</mat-checkbox>
					</th>
					<td *matCellDef="let row; let i = index" mat-cell>
						<button (click)="editRow(i, row)"
								color="accent"
								mat-icon-button>
							<span class="material-symbols-outlined notranslate">
								edit
							</span>
						</button>
						<mat-checkbox
							color="warn"
							(change)="$event ? selection.toggle(row) : null"
							(click)="$event.stopPropagation()"
							[checked]="selection.isSelected(row)">
						</mat-checkbox>
					</td>
				</ng-container>
				<ng-container *ngIf="column !== actionColum">
					<th *matHeaderCellDef mat-header-cell>
						{{column}}
					</th>
					<td *matCellDef="let row" mat-cell>
						<app-cell
							*ngIf="column !== actionColum"
							[row]="row"
							[column]="column"
						></app-cell>
					</td>
				</ng-container>
			</ng-container>

			<tr *matHeaderRowDef="displayedColumns; sticky: true" mat-header-row></tr>
			<tr *matRowDef="let row; columns: displayedColumns;" mat-row></tr>
		</table>
	</div>
	<mat-paginator
		showFirstLastButtons
		hidePageSize
		pageSize="100"
	></mat-paginator>
</div>
