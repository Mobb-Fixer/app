<mat-toolbar
	fxLayout="row"
	fxLayoutAlign="space-between center">

	<mat-form-field appearance="standard" style="width: 80%">
		<input [(ngModel)]="filter"
			   placeholder="Search History"
			   autocomplete="off"
			   matInput>
		<button (click)="filter=''" *ngIf="filter" aria-label="Clear"
				mat-button mat-icon-button
				matSuffix>
			<mat-icon>close</mat-icon>
		</button>
	</mat-form-field>

	<mat-button-toggle-group
		(change)="order = $event.value"
	>
		<mat-button-toggle
			checked
			matTooltip="From most recent to older"
			value="time"
		>
			<span class="material-symbols-outlined notranslate">
				schedule
			</span>
		</mat-button-toggle>
		<mat-button-toggle
			matTooltip="From most runned to least runned"
			value="occurrence"
		>
			<span class="material-symbols-outlined notranslate">
				play_circle
			</span>
		</mat-button-toggle>
	</mat-button-toggle-group>
</mat-toolbar>

<div style="height: calc(100vh - 56px); overflow: auto; max-width: 50vw;">
	<mat-card *ngIf="queryHistory.length < 1">
		<mat-card-header>
			No history yet
			<br>
			Runned queries with appears here
		</mat-card-header>
	</mat-card>

	<mat-card *ngFor="let his of queryHistory | sort: order"
			  [hidden]="his.query.toLowerCase().indexOf(filter.toLowerCase()) < 0"
			  [style.background-color]="his.star ? 'black' : undefined">
		<mat-card-content>
			<div class="actions">
				<button (click)="changeStar(his)"
						mat-icon-button>
					<span class="material-symbols-outlined notranslate">star</span>
				</button>

				<button
					(click)="goToQuery(his.query)"
					mat-icon-button>
					<span class="material-symbols-outlined notranslate">play_arrow</span>
				</button>

				<button
					(click)="snackBar.open('Copied to clipboard', 'â•³', {duration: 3000})"
					[cdkCopyToClipboard]="his.query"
					mat-icon-button>
					<span class="material-symbols-outlined notranslate">
						file_copy
					</span>
				</button>

				<button
					(click)="remove(his)"
					mat-icon-button>
					<span class="material-symbols-outlined notranslate">
						remove
					</span>
				</button>
			</div>
			<pre><code [highlight]="his.query"
					   [languages]="[selectedServer.driver!.language.id]"
					   [lineNumbers]="true">
			</code></pre>
		</mat-card-content>

		<mat-card-actions>
			<h4>
				{{his.nbResult}} rows
			</h4>

			<h4>
				{{his.date | date: 'HH:mm dd/MM'}}
			</h4>

			<h4>
				{{his.occurrence}} runs
			</h4>
		</mat-card-actions>
	</mat-card>
</div>
